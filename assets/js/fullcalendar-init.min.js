var calendar;document.addEventListener("DOMContentLoaded",function(){var b=document.getElementById("calendar");var c=[];function a(e){if(!confirm(fullcalendarOptions.confirmMoveMessage)){e.revert()}else{var d=e.event.end;if(null===d&&false===e.event.allDay){d=new Date(e.event.start.getTime()+3600000)}c.booking=$.ajax({type:"POST",url:fullcalendarOptions.events.targetUrl,data:{_ajax_nonce:fullcalendarOptions.events.nonce,id:e.event.id,start:e.event.start!==null?e.event.start.toISOString():null,end:d!==null?d.toISOString():null,allDay:e.event.allDay,resource:e.hasOwnProperty("newResource")&&e.newResource!==null?e.newResource.id:null},success:function(f){calendar.refetchEvents()},error:function(f,h,g){e.revert()},complete:function(){},dataType:"json"})}}calendar=new FullCalendar.Calendar(b,{plugins:["interaction","resourceDayGrid","resourceTimeGrid","list"],defaultView:fullcalendarOptions.defaultView,defaultDate:fullcalendarOptions.defaultDate,schedulerLicenseKey:fullcalendarOptions.schedulerLicenseKey,allDaySlot:true,editable:true,selectable:true,eventLimit:true,nowIndicator:true,navLinks:true,contentHeight:"auto",businessHours:[{daysOfWeek:[1,2,3,4,5],startTime:"08:00",endTime:"18:00"},{daysOfWeek:[6],startTime:"10:00",endTime:"16:00"},{daysOfWeek:[0],startTime:"13:00",endTime:"20:00"}],customButtons:{addButton:{icon:"fc-icon-plus-square",click:function(){tb_show(fullcalendarOptions.createEventTitle,fullcalendarOptions.events.newUrl)}}},header:{left:"addButton, prev,next today",center:"title",right:"resourceTimeGridDay,resourceTimeGridTwoDay,timeGridWeek,dayGridMonth,listWeek"},views:{resourceTimeGridTwoDay:{type:"resourceTimeGrid",duration:{days:2},buttonText:"2 days"},listWeek:{buttonText:"list"}},resources:fullcalendarOptions.resources,eventSources:[{url:fullcalendarOptions.events.sourceUrl,method:"POST",extraParams:{_ajax_nonce:fullcalendarOptions.events.nonce}}],eventRender:function(d){if(d.view.constructor.name==="DayGridView"){if(!d.event.extendedProps.hasOwnProperty("isExternal")||!d.event.extendedProps.isExternal){$(d.el).find(".fc-title").first().before('<span class="wbe-booking-id">#'+d.event.id+"</span>")}if(d.event.extendedProps.hasOwnProperty("bookedBy")){$(d.el).find(".fc-content").first().append('<span class="wbe-booked-by">Booked by '+d.event.extendedProps.bookedBy+"</span>")}if(d.event.extendedProps.hasOwnProperty("bookedFor")){$(d.el).find(".fc-content").first().append('<span class="wbe-booked-for">Booked for '+d.event.extendedProps.bookedFor+"</span>")}if(d.event.extendedProps.hasOwnProperty("persons")){$(d.el).find(".fc-content").first().append('<span class="wbe-pax">('+d.event.extendedProps.persons+" pax)</span>")}}else{if(!d.event.extendedProps.hasOwnProperty("isExternal")||!d.event.extendedProps.isExternal){$(d.el).find(".fc-title").first().before('<div class="wbe-booking-id">#'+d.event.id+"</div>")}if(d.event.extendedProps.hasOwnProperty("bookedBy")){$(d.el).find(".fc-content").first().append('<div class="wbe-booked-by">Booked by '+d.event.extendedProps.bookedBy+"</div>")}if(d.event.extendedProps.hasOwnProperty("bookedFor")){$(d.el).find(".fc-content").first().append('<div class="wbe-booked-for">Booked for '+d.event.extendedProps.bookedFor+"</div>")}if(d.event.extendedProps.hasOwnProperty("persons")){$(d.el).find(".fc-content").first().append('<div class="wbe-pax">('+d.event.extendedProps.persons+" pax)</div>")}if(d.view.constructor.name==="ResourceTimeGridView"){$(d.el).find(".fc-title").remove()}}},eventResize:a,eventDrop:a,select:function(d){var e={_wpnonce:fullcalendarOptions.events.nonce,start:d.start!==null?d.start.toISOString():null,end:d.end!==null?d.end.toISOString():null,allDay:d.allDay,resource:d.hasOwnProperty("resource")&&d.resource!==null?d.resource.id:null};tb_show(fullcalendarOptions.createEventTitle,fullcalendarOptions.events.newUrl+"&"+$.param(e))},dateClick:function(d){console.log("dateClick",d.date,d.resource?d.resource.id:"(no resource)")}});calendar.render()});