function OverviewCalendar(b,a){var c=jQuery;this.products=a;this.calendarId="#"+b;this.date=new Date();this.moment=moment(this.date.getTime());this.render=function(){c(this.calendarId).find(".fc-toolbar .fc-center h2").text(this.moment.format("MMMM Y"));c(this.calendarId).find("tbody").children().remove();var d="";for(var e=0;e<this.products.length;e++){d+='<td class="wbe-product-cell-'+this.products[e]+'"></td>'}var g=this.moment.startOf("month").clone();while(g.month()===this.moment.month()){c(this.calendarId).find("tbody").append('<tr id="wbe-day-row-'+g.date()+'"><td>'+g.date()+", "+g.format("ddd")+"</td>"+d+"</tr>");g.add(1,"d")}for(var e=0;e<this.products.length;e++){var f={product_id:this.products[e]};c.ajax({type:"POST",url:calendarOverview.url,data:{_ajax_nonce:calendarOverview.nonce,product_id:this.products[e],start:this.moment.startOf("month").toISOString(),end:this.moment.endOf("month").toISOString()},dataType:"json",success:c.proxy(function(m,l){for(var j=0;j<l.length;j++){var o=moment(l[j].start);var i=moment(l[j].end);if(l[j].allDay){i.subtract(1,"h")}if(!l[j].hasOwnProperty("isExternal")||false===l[j].isExternal){var h=o.clone();while(h.date()<=i.date()&&dateCrawl.month()===this.moment.month()){var n=c(this.calendarId).find("#wbe-day-row-"+h.date()).find(".wbe-product-cell-"+m.product_id);n.addClass("wbe-date-booked");h.add(1,"d")}}}},this,f),error:function(h,j,i){},complete:function(){}})}};this.monthAdvance=function(){this.date.setMonth(this.date.getMonth()+1);this.moment=this.moment.add(1,"M");this.render()};this.monthReverse=function(){this.date.setMonth(this.date.getMonth()-1);this.moment=this.moment.subtract(1,"M");this.render()}}jQuery(function(a){a(function(){var b=new OverviewCalendar(calendarOverview.calendarId,calendarOverview.products);a("#"+calendarOverview.calendarId).find(".fc-next-button").on("click",function(){b.monthAdvance()});a("#"+calendarOverview.calendarId).find(".fc-prev-button").on("click",function(){b.monthReverse()});b.render()})});
